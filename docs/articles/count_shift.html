<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Count and Shift Tables • Tplyr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Count and Shift Tables">
<meta property="og:description" content="Tplyr">
<meta property="og:image" content="/reference/figures/Atorus_Stickers_vF_Tplyr.png">
<meta property="og:image:alt" content="Tplyr Hex Sticker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@AtorusR">
<meta name="twitter:site" content="@AtorusR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Tplyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Tplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Table Vignettes</li>
    <li>
      <a href="../articles/table.html">Tplyr Table Properties</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Layer Vignettes</li>
    <li>
      <a href="../articles/desc.html">Descriptive Statistic Layers</a>
    </li>
    <li>
      <a href="../articles/count_shift.html">Count and Shift Tables</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers</li>
    <li>
      <a href="../articles/riskdiff.html">Risk Difference</a>
    </li>
    <li>
      <a href="../articles/sort.html">Sorting a Tplyr Table</a>
    </li>
    <li>
      <a href="../articles/options.html">Tplyr Options</a>
    </li>
    <li>
      <a href="../articles/styled-table.html">Producing a Styled Table</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atorus-research/Tplyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Count and Shift Tables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atorus-research/Tplyr/blob/master/vignettes/count_shift.Rmd"><code>vignettes/count_shift.Rmd</code></a></small>
      <div class="hidden name"><code>count_shift.Rmd</code></div>

    </div>

    
    
<div id="frequency-tables" class="section level1">
<h1 class="hasAnchor">
<a href="#frequency-tables" class="anchor"></a>Frequency Tables</h1>
<p>At the surface, counting sounds pretty simple, right? You just want to know how many occurrences of something there are. Well - unfortunately, it’s not that easy. And in clinical reports, there’s quite a bit of nuance that goes into the different types of frequency tables that need to be created. Fortunately, we’ve added a good bit of flexibility into both <code><a href="../reference/layer_constructors.html">group_count()</a></code> and <code><a href="../reference/layer_constructors.html">group_shift()</a></code> to help you get what you need when creating these reports, whether you’re creating a demographics table, adverse events, of shift in lab results.</p>
<div id="a-simple-example" class="section level3">
<h3 class="hasAnchor">
<a href="#a-simple-example" class="anchor"></a>A Simple Example</h3>
<p>Let’s start with a basic example. This table demonstrates the distribution of subject disposition across treatment groups. Additionally, we’re sorting by descending total occurrences using the “Total” group.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>, <span class="kw">where</span> <span class="kw">=</span> <span class="no">SAFFL</span> <span class="kw">==</span> <span class="st">"Y"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/treat_grps.html">add_total_group</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/treat_grps.html">add_treat_grps</a></span>(<span class="kw">Treated</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Xanomeline Low Dose"</span>, <span class="st">"Xanomeline High Dose"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">DCDECOD</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/ordering.html">set_order_count_method</a></span>(<span class="st">"bycount"</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/ordering.html">set_ordering_cols</a></span>(<span class="no">Total</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">ord_layer_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"row"</span>), <span class="no">var1_Placebo</span>, <span class="no">`var1_Xanomeline Low Dose`</span>,
         <span class="no">`var1_Xanomeline High Dose`</span>, <span class="no">var1_Treated</span>, <span class="no">var1_Total</span>)

<span class="fu">kable</span>(<span class="no">t</span>)</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Treated
</th>
<th style="text-align:left;">
var1_Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
COMPLETED
</td>
<td style="text-align:left;">
58 ( 67.4%)
</td>
<td style="text-align:left;">
25 ( 29.8%)
</td>
<td style="text-align:left;">
27 ( 32.1%)
</td>
<td style="text-align:left;">
52 ( 31.0%)
</td>
<td style="text-align:left;">
110 ( 43.3%)
</td>
</tr>
<tr>
<td style="text-align:left;">
ADVERSE EVENT
</td>
<td style="text-align:left;">
8 ( 9.3%)
</td>
<td style="text-align:left;">
44 ( 52.4%)
</td>
<td style="text-align:left;">
40 ( 47.6%)
</td>
<td style="text-align:left;">
84 ( 50.0%)
</td>
<td style="text-align:left;">
92 ( 36.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
WITHDRAWAL BY SUBJECT
</td>
<td style="text-align:left;">
9 ( 10.5%)
</td>
<td style="text-align:left;">
10 ( 11.9%)
</td>
<td style="text-align:left;">
8 ( 9.5%)
</td>
<td style="text-align:left;">
18 ( 10.7%)
</td>
<td style="text-align:left;">
27 ( 10.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
STUDY TERMINATED BY SPONSOR
</td>
<td style="text-align:left;">
2 ( 2.3%)
</td>
<td style="text-align:left;">
2 ( 2.4%)
</td>
<td style="text-align:left;">
3 ( 3.6%)
</td>
<td style="text-align:left;">
5 ( 3.0%)
</td>
<td style="text-align:left;">
7 ( 2.8%)
</td>
</tr>
<tr>
<td style="text-align:left;">
PROTOCOL VIOLATION
</td>
<td style="text-align:left;">
2 ( 2.3%)
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
3 ( 3.6%)
</td>
<td style="text-align:left;">
4 ( 2.4%)
</td>
<td style="text-align:left;">
6 ( 2.4%)
</td>
</tr>
<tr>
<td style="text-align:left;">
LACK OF EFFICACY
</td>
<td style="text-align:left;">
3 ( 3.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
1 ( 0.6%)
</td>
<td style="text-align:left;">
4 ( 1.6%)
</td>
</tr>
<tr>
<td style="text-align:left;">
DEATH
</td>
<td style="text-align:left;">
2 ( 2.3%)
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 0.6%)
</td>
<td style="text-align:left;">
3 ( 1.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
PHYSICIAN DECISION
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 ( 2.4%)
</td>
<td style="text-align:left;">
2 ( 1.2%)
</td>
<td style="text-align:left;">
3 ( 1.2%)
</td>
</tr>
<tr>
<td style="text-align:left;">
LOST TO FOLLOW-UP
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
1 ( 1.2%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 0.6%)
</td>
<td style="text-align:left;">
2 ( 0.8%)
</td>
</tr>
</tbody>
</table>
</div>
<div id="percentages" class="section level2">
<h2 class="hasAnchor">
<a href="#percentages" class="anchor"></a>Percentages</h2>
<p>Counting is one thing - but a count by itself doesn’t give much context. Often frequencies in clinical reports are paired with a percentage, which allows you to understand the proportion of events/subjects to some total - but that total can prove to be complicated, which is why we’ve included a few functions to aid in giving you the necessary denominator.</p>
<ul>
<li>
<code><a href="../reference/set_denoms_by.html">set_denoms_by()</a></code> function allows users calculate denominators using any variable within the <code>by</code>, <code>cols</code>, <code>treatment</code>, or <code>target_var</code>. This defaults to all variables passed as treatment groups and column variables which causes the column percentages to sum to 100%. This is particularly useful for shift tables, which use a combination of row and column variables.
<ul>
<li>
<code><a href="../reference/set_denom_ignore.html">set_denom_ignore()</a></code> defines values of the target variable to be ignored in the calculation of the denominator. In many tables percentages are based on non-missing counts. You can pass values to this function to have them be excluded from the calculation of the denominator. For example, if your data include NAs, you can use “NA” in <code><a href="../reference/set_denom_ignore.html">set_denom_ignore()</a></code> and those will be excluded from the denominator.</li>
</ul>
</li>
</ul>
<p>Examples with percentages can be seen below.</p>
</div>
<div id="distinct-versus-event-counts" class="section level2">
<h2 class="hasAnchor">
<a href="#distinct-versus-event-counts" class="anchor"></a>Distinct Versus Event Counts</h2>
<p>Just as important as denominator flexibility is the determination of whether you should be using distinct or non-distinct counts - or some combination of both. Adverse event tables are a perfect example. Often, you’re concerned about how many subjects had an adverse event in particular instead of just the number of occurrences of that adverse event. Similarly, the number occurrences of an event isn’t necessarily relevant when compared to the total number of adverse events that occurred. For this reason, what you likely want to look at is instead the number of subjects who experienced an event compared to the total number of subjects in that treatment group.</p>
<p>‘Tplyr’ allows you to focus on these distinct counts and distinct percents within some grouping variable, like subject. Additionally, you can mix and match with the distinct counts with non-distinct counts in the same row too. The <code><a href="../reference/set_distinct_by.html">set_distinct_by()</a></code> function sets the variables used to calculate the distinct occurrences of some value using the specified <code>by</code> variables.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AEDECOD</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_distinct_by.html">set_distinct_by</a></span>(<span class="no">USUBJID</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx (xx.xx%) [xxx]"</span>, <span class="no">distinct</span>, <span class="no">distinct_pct</span>, <span class="no">n</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()

<span class="fu">kable</span>(<span class="no">t</span>)</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ACTINIC KERATOSIS
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
1 ( 2.38%) [ 1]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
ALOPECIA
</td>
<td style="text-align:left;">
1 ( 4.76%) [ 1]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
BLISTER
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
1 ( 2.38%) [ 2]
</td>
<td style="text-align:left;">
5 (11.90%) [ 8]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
COLD SWEAT
</td>
<td style="text-align:left;">
1 ( 4.76%) [ 3]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
DERMATITIS ATOPIC
</td>
<td style="text-align:left;">
1 ( 4.76%) [ 1]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
DERMATITIS CONTACT
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
0 ( 0.00%) [ 0]
</td>
<td style="text-align:left;">
1 ( 2.38%) [ 2]
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
<p>You may have seen tables before like the one about. This display shows the number of subjects who experienced an adverse event, the percentage of subjects within the given treatment group who experienced that event, and then the total number of occurrences of that event. Using <code><a href="../reference/set_distinct_by.html">set_distinct_by()</a></code> triggered the derivation of <code>distinct</code> and <code>distinct_pct</code> in addition to the <code>n</code> and <code>pct</code> created created within <code>group_count</code>. The display of the values is then controlled by the <code><a href="../reference/f_str.html">f_str()</a></code> call in <code><a href="../reference/set_format_strings.html">set_format_strings()</a></code>.</p>
</div>
<div id="adding-a-total-row" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-a-total-row" class="anchor"></a>Adding a ‘Total’ Row</h2>
<p>Some summaries require the addition of a ‘Total’ row in addition to the categorical counts. ‘Tplyr’ has the helper function <code><a href="../reference/add_total_row.html">add_total_row()</a></code> to ease this process for you. The default text for this row is “Total”, but we provide <code><a href="../reference/set_total_row_label.html">set_total_row_label()</a></code> to allow you to customize the text used for the ‘Total’ row.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adsl</span>, <span class="no">TRT01P</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AGEGR1</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/add_total_row.html">add_total_row</a></span>() <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_total_row_label.html">set_total_row_label</a></span>(<span class="st">"All Age Groups"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
&lt;65
</td>
<td style="text-align:left;">
14 ( 16.3%)
</td>
<td style="text-align:left;">
11 ( 13.1%)
</td>
<td style="text-align:left;">
8 ( 9.5%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
&gt;80
</td>
<td style="text-align:left;">
30 ( 34.9%)
</td>
<td style="text-align:left;">
18 ( 21.4%)
</td>
<td style="text-align:left;">
29 ( 34.5%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
65-80
</td>
<td style="text-align:left;">
42 ( 48.8%)
</td>
<td style="text-align:left;">
55 ( 65.5%)
</td>
<td style="text-align:left;">
47 ( 56.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
All Age Groups
</td>
<td style="text-align:left;">
86 (100.0%)
</td>
<td style="text-align:left;">
84 (100.0%)
</td>
<td style="text-align:left;">
84 (100.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
</div>
<div id="missing-counts" class="section level2">
<h2 class="hasAnchor">
<a href="#missing-counts" class="anchor"></a>Missing Counts</h2>
<p>Missing counts are another tricky area for frequency tables. These values raise a number of questions. For example, do you want to format the missing counts the same way as the event counts? Do you want to present missing counts with percentages? Do missing counts belong in the denominator?</p>
<p>The <code><a href="../reference/set_missing_count.html">set_missing_count()</a></code> function can take a new <code><a href="../reference/f_str.html">f_str()</a></code> object to set the display of missing values. Additionally, using the <code>string</code> parameter you can set the value chosen to be summarized as missing. By using a named character vector, you can control the <code>row_label</code> of what will be used for missing values.</p>
<p>In the example below 50 random values are removed and NA is specified as the missing string. The NAs are additionally ignored in denominators by using <code><a href="../reference/set_denom_ignore.html">set_denom_ignore()</a></code>. Note that NA is submitted to these functions as a string even though the values are NAs in the data (i.e. not strings containing “NA”). During processing, the NAs are coerced into characters.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">adae2</span> <span class="kw">&lt;-</span> <span class="no">adae</span>
<span class="no">adae2</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">adae2</span>), <span class="fl">50</span>), <span class="st">"AESEV"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">t</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae2</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="no">AESEV</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx (xx.xx%)"</span>, <span class="no">n</span>, <span class="no">pct</span>)) <span class="kw">%&gt;%</span>
      <span class="co"># AESEV of SEVERE is used to demonstrate missing</span>
      <span class="fu"><a href="../reference/set_missing_count.html">set_missing_count</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xxx"</span>, <span class="no">n</span>), <span class="kw">string</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">MISSING</span> <span class="kw">=</span> <span class="st">"NA"</span>))  <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_denom_ignore.html">set_denom_ignore</a></span>(<span class="st">"NA"</span>)

  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>()

<span class="no">t</span> <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MILD
</td>
<td style="text-align:left;">
21 (44.68%)
</td>
<td style="text-align:left;">
65 (58.56%)
</td>
<td style="text-align:left;">
43 (36.44%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MODERATE
</td>
<td style="text-align:left;">
18 (38.30%)
</td>
<td style="text-align:left;">
23 (20.72%)
</td>
<td style="text-align:left;">
51 (43.22%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
SEVERE
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
1 ( 0.90%)
</td>
<td style="text-align:left;">
4 ( 3.39%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
MISSING
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
</div>
<div id="nested-count-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#nested-count-summaries" class="anchor"></a>Nested Count Summaries</h2>
<p>Certain summary tables present counts within groups. One example could be in a disposition table where a disposition reason of “Other” summarizes what those other reasons were. A very common example is an Adverse Event table that displays counts for body systems, and then the events within those body systems. This is again a nuanced situation - there are two variables being summarized: The body system counts, and the advert event counts.</p>
<p>One way to approach this would be creating two summaries. One summarizing the body system, and another summarizing the preferred terms by body system, and then merging the two together. But we don’t want you to have to do that. Instead, we handle this complexity for you. This is done in <code><a href="../reference/layer_constructors.html">group_count()</a></code> by submitting two target variables with <code><a href="https://dplyr.tidyverse.org/reference/vars.html">dplyr::vars()</a></code>. The first variable should be your grouping variable that you want summarized, which we refer to as the “Outside” variable, and the second should have the narrower scope, which we call the “Inside” variable.</p>
<p>The example below demonstrates how to do a nested summary. Look at the first row - here <code>row_label1</code> and <code>row_label2</code> are both “CARDIAC DISORDERS”. This line is the summary for <code>AEBODSYS.</code> In the rows below that, <code>row_label1</code> continues on with the value “CARDIAC DISORDERS”, but <code>row_label2</code> changes. These are the summaries for <code>AEDECOD</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">AEBODSYS</span>, <span class="no">AEDECOD</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
47 (100.0%)
</td>
<td style="text-align:left;">
111 (100.0%)
</td>
<td style="text-align:left;">
118 (100.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
Inf
</td>
</tr>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
ACTINIC KERATOSIS
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 0.9%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
ALOPECIA
</td>
<td style="text-align:left;">
1 ( 2.1%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
BLISTER
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 ( 1.8%)
</td>
<td style="text-align:left;">
8 ( 6.8%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
COLD SWEAT
</td>
<td style="text-align:left;">
3 ( 6.4%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
DERMATITIS ATOPIC
</td>
<td style="text-align:left;">
1 ( 2.1%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>This accomplishes what we needed, but it’s not exactly the presentation you might hope for. We have a solution for this as well.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adae</span>, <span class="no">TRTA</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_count</a></span>(<span class="fu">vars</span>(<span class="no">AEBODSYS</span>, <span class="no">AEDECOD</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_nest_count.html">set_nest_count</a></span>(<span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_indentation.html">set_indentation</a></span>(<span class="st">"---&gt;"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
var1_Placebo
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
SKIN AND SUBCUTANEOUS TISSUE DISORDERS
</td>
<td style="text-align:left;">
47 (100.0%)
</td>
<td style="text-align:left;">
111 (100.0%)
</td>
<td style="text-align:left;">
118 (100.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
Inf
</td>
</tr>
<tr>
<td style="text-align:left;">
—&gt;ACTINIC KERATOSIS
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 0.9%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
—&gt;ALOPECIA
</td>
<td style="text-align:left;">
1 ( 2.1%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
—&gt;BLISTER
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 ( 1.8%)
</td>
<td style="text-align:left;">
8 ( 6.8%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
—&gt;COLD SWEAT
</td>
<td style="text-align:left;">
3 ( 6.4%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
—&gt;DERMATITIS ATOPIC
</td>
<td style="text-align:left;">
1 ( 2.1%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>By using <code><a href="../reference/set_nest_count.html">set_nest_count()</a></code>, this triggers ‘Tplyr’ to drop row_label1, and indent all of the AEDECOD values within row_label2. The columns are renamed appropriately as well. The default indentation used will be 3 spaces, but as you can see here - you can set the indentation however you like. This let’s you use tab strings for different language-specific output types, stick with spaces, indent wider or smaller - whatever you wish. All of the existing order variables remain, so this has no impact on your ability to sort the table.</p>
</div>
<div id="shift-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#shift-tables" class="anchor"></a>Shift Tables</h2>
<p>Shift tables are a special kind of frequency table - but what they count are changes in state. This is most common when looking at laboratory ranges, where you may be interested in a subject’s status at baseline versus their status at some designated evaluation point. Shift tables allow you to see the distribution of how subjects move between normal ranges, and if the population is improving or worsening as the study progresses.</p>
<p>While shift tables are very similar to a normal frequency table, there’s more nuance here, and thus we decided to create <code><a href="../reference/layer_constructors.html">group_shift()</a></code>. This function is largely an abstraction of a count layer, and in fact re-uses a good deal of the same underlying code. But we handle some of the complexity for you to make the interface easy to use and the behavior similar to that of the <code><a href="../reference/layer_constructors.html">group_count()</a></code> and <code><a href="../reference/layer_constructors.html">group_desc()</a></code> APIs.</p>
<p>One thing to note - the <code><a href="../reference/layer_constructors.html">group_shift()</a></code> API is intended to be used on shift tables where one group is presented in rows and the other group in columns. Occasionally, shift tables will have a row based approach that shows “Low to High”, “Normal to High”, etc. For those situations, <code><a href="../reference/layer_constructors.html">group_count()</a></code> will do just fine.</p>
<p>Let’s look at an example.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">VISIT</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">20</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
row_label3
</th>
<th style="text-align:left;">
var1_Placebo_H
</th>
<th style="text-align:left;">
var1_Placebo_N
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_N
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
<th style="text-align:right;">
ord_layer_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 12
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 12
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 24
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 24
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 8
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 8
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>For the most part, this is getting us where we want to go - but there’s still some that’s left to be desired. It doesn’t look like there are any ‘L’ values for BNRIND in the dataset so we are not getting and rows containing ‘L’. Let’s see if we can fix that by dummying in the possible values.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">adlb</span>$<span class="no">ANRIND</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adlb</span>$<span class="no">ANRIND</span>, <span class="kw">levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L"</span>, <span class="st">"N"</span>, <span class="st">"H"</span>))
<span class="no">adlb</span>$<span class="no">BNRIND</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">adlb</span>$<span class="no">BNRIND</span>, <span class="kw">levels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"L"</span>, <span class="st">"N"</span>, <span class="st">"H"</span>))
<span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">VISIT</span>))
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fl">20</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
row_label3
</th>
<th style="text-align:left;">
var1_Placebo_L
</th>
<th style="text-align:left;">
var1_Placebo_N
</th>
<th style="text-align:left;">
var1_Placebo_H
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_H
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
<th style="text-align:right;">
ord_layer_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 12
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 12
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 12
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 24
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 24
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 24
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 8
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 8
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
WEEK 8
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>There we go. This is another situation where using factors in R let’s us dummy values within the dataset. Furthermore, since factors are ordered, it automatically corrected the sort order of the row labels too. Check out the <code><a href="https://rdrr.io/r/utils/vignette.html">vignettes("sort")</a></code> for more information on sorting.</p>
<p>A major part of the shift API is the control of the denominators used in the calculation of the percentages. In frequency tables, a lot of the time you want the columns within a by group to sum to 100%. In shift tables, most percentages are relative to the “box” that is formed from the “from” and “to” groups of the shift for each treatment group. To support this, ‘Tplyr’ let’s you specify the grouping used to calculate the denominators.</p>
<p>Just like the count layers, the <code><a href="../reference/set_denoms_by.html">set_denoms_by()</a></code> functions any variable name from the treatment variable, <code>cols</code> argument, <code>by</code> variables, and the target variables.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">AVISIT</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xxx.x%)"</span>, <span class="no">n</span>, <span class="no">pct</span>)) <span class="kw">%&gt;%</span>
      <span class="co"># This is the default, the 3x3 box formed by the target variables</span>
      <span class="fu"><a href="../reference/set_denoms_by.html">set_denoms_by</a></span>(<span class="no">TRTA</span>, <span class="no">PARAM</span>, <span class="no">AVISIT</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
row_label3
</th>
<th style="text-align:left;">
var1_Placebo_L
</th>
<th style="text-align:left;">
var1_Placebo_N
</th>
<th style="text-align:left;">
var1_Placebo_H
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_H
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
<th style="text-align:right;">
ord_layer_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
11 ( 91.7%)
</td>
<td style="text-align:left;">
1 ( 8.3%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 75.0%)
</td>
<td style="text-align:left;">
1 ( 12.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 85.7%)
</td>
<td style="text-align:left;">
1 ( 14.3%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 ( 12.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
10 ( 83.3%)
</td>
<td style="text-align:left;">
2 ( 16.7%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 (100.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 (100.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 85.7%)
</td>
<td style="text-align:left;">
1 ( 14.3%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
9 ( 90.0%)
</td>
<td style="text-align:left;">
1 ( 10.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 (100.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>In the example above, the denominators were based on the by and treatment variables, <code>TRTA</code>, <code>PARAM</code> and <code>VISIT</code>. This creates a 3 X 3 box, where the denominator is the total of all record within the <strong>FROM</strong> and <strong>TO</strong> shift variables, within each parameter, visit, and treatment. This is the default, and this is how ‘Tplyr’ will create the denominators if <code>set_denom_by()</code> isn’t specified.</p>
<p>In the next example, the percentage denominators are calculated row-wise, each row percentage sums to 100%.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span><span class="kw">=</span><span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">AVISIT</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xxx.x%)"</span>, <span class="no">n</span>, <span class="no">pct</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_denoms_by.html">set_denoms_by</a></span>(<span class="no">BNRIND</span>, <span class="no">PARAM</span>, <span class="no">AVISIT</span>) <span class="co"># Each row made by LBNRIND, TRTA</span>
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="no">ord_layer_1</span>, <span class="no">ord_layer_2</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
row_label3
</th>
<th style="text-align:left;">
var1_Placebo_L
</th>
<th style="text-align:left;">
var1_Placebo_N
</th>
<th style="text-align:left;">
var1_Placebo_H
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_H
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
<th style="text-align:right;">
ord_layer_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 8
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 26.1%)
</td>
<td style="text-align:left;">
1 ( 4.3%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
9 ( 39.1%)
</td>
<td style="text-align:left;">
1 ( 4.3%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 26.1%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
1 (100.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
11 ( 42.3%)
</td>
<td style="text-align:left;">
1 ( 3.8%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 23.1%)
</td>
<td style="text-align:left;">
1 ( 3.8%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
6 ( 23.1%)
</td>
<td style="text-align:left;">
1 ( 3.8%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
10 ( 62.5%)
</td>
<td style="text-align:left;">
2 ( 12.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 ( 12.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:left;">
2 ( 12.5%)
</td>
<td style="text-align:left;">
0 ( 0.0%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>While not practical, in this last example the denominators are changed to be based on the entire column instead of the 3 x 3 box. By passing the column variables, <code>TRTA</code> and <code>ANRIND</code> the layer will use those denominators when determining the percentages.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/tplyr_table.html">tplyr_table</a></span>(<span class="no">adlb</span>, <span class="no">TRTA</span>, <span class="kw">where</span> <span class="kw">=</span> <span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">"CK"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/layer_attachment.html">add_layer</a></span>(
    <span class="fu"><a href="../reference/layer_constructors.html">group_shift</a></span>(<span class="fu">vars</span>(<span class="kw">row</span> <span class="kw">=</span> <span class="no">BNRIND</span>, <span class="kw">column</span> <span class="kw">=</span> <span class="no">ANRIND</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fu">vars</span>(<span class="no">PARAM</span>, <span class="no">AVISIT</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_format_strings.html">set_format_strings</a></span>(<span class="fu"><a href="../reference/f_str.html">f_str</a></span>(<span class="st">"xx (xx.xx%)"</span>, <span class="no">n</span>, <span class="no">pct</span>)) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="../reference/set_denoms_by.html">set_denoms_by</a></span>(<span class="no">TRTA</span>, <span class="no">ANRIND</span>) <span class="co"># Use the column total as the denominator</span>
  ) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/build.html">build</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
row_label1
</th>
<th style="text-align:left;">
row_label2
</th>
<th style="text-align:left;">
row_label3
</th>
<th style="text-align:left;">
var1_Placebo_L
</th>
<th style="text-align:left;">
var1_Placebo_N
</th>
<th style="text-align:left;">
var1_Placebo_H
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline High Dose_H
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_L
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_N
</th>
<th style="text-align:left;">
var1_Xanomeline Low Dose_H
</th>
<th style="text-align:right;">
ord_layer_index
</th>
<th style="text-align:right;">
ord_layer_1
</th>
<th style="text-align:right;">
ord_layer_2
</th>
<th style="text-align:right;">
ord_layer_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
11 (40.74%)
</td>
<td style="text-align:left;">
1 (25.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
6 (35.29%)
</td>
<td style="text-align:left;">
1 (33.33%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
6 (42.86%)
</td>
<td style="text-align:left;">
1 (100.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 12
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
1 (33.33%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
L
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
10 (37.04%)
</td>
<td style="text-align:left;">
2 (50.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
2 (11.76%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
2 (14.29%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Creatine Kinase (U/L)
</td>
<td style="text-align:left;">
Week 24
</td>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:left;">
0 ( 0.00%)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>Our hope is that this gives you the flexibility you need to structure your denominator however required.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eli Miller, Mike Stackhouse, Ashley Tarasiewicz, Nathan Kosiba.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
